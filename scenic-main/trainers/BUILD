load("//devtools/python/blaze:pytype.bzl", "pytype_strict_library")

pytype_strict_library(
    name = "lsm_mae_trainer",
    srcs = ["lsm_mae_trainer.py"],
    deps = [
        ":linear_probe_utils",
        ":lsm_mae_reconstruction_eval",
        ":lsm_mae_utils",
        "//third_party/py/absl/logging",
        "//third_party/py/clu:periodic_actions",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/clu/platform",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_mae_utils",
    srcs = ["lsm_mae_utils.py"],
    deps = [
        "//third_party/py/absl/logging",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/optax",
        "//third_party/py/scenic/model_lib/layers:nn_ops",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_supervised_trainer",
    srcs = ["lsm_supervised_trainer.py"],
    deps = [
        ":lsm_supervised_utils",
        "//experimental/largesensormodels/scenic/utils:classification_utils",
        "//third_party/py/absl/logging",
        "//third_party/py/clu:periodic_actions",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/clu/platform",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/projects/baselines:vit",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_supervised_utils",
    srcs = ["lsm_supervised_utils.py"],
    deps = [
        "//third_party/py/flax:core",
        "//third_party/py/flax/training:common_utils",
        "//third_party/py/jax",
        "//third_party/py/jax:optimizers",
        "//third_party/py/ml_collections",
        "//third_party/py/optax",
        "//third_party/py/scenic/model_lib/base_models:classification_model",
        "//third_party/py/scenic/model_lib/base_models:model_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_supervised_standalone_eval",
    srcs = ["lsm_supervised_standalone_eval.py"],
    deps = [
        ":lsm_supervised_utils",
        "//experimental/largesensormodels/scenic/utils:classification_utils",
        "//third_party/py/absl/logging",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/projects/baselines:vit",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_linear_probe_standalone_trainer",
    srcs = ["lsm_linear_probe_standalone_trainer.py"],
    deps = [
        ":lsm_supervised_utils",
        "//experimental/largesensormodels/scenic/models/lsm_vit_utils:model_utils",
        "//experimental/largesensormodels/scenic/utils:classification_utils",
        "//third_party/py/absl/logging",
        "//third_party/py/clu:periodic_actions",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/clu/platform",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/model_lib/layers:nn_layers",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_linear_probe_standalone_eval",
    srcs = ["lsm_linear_probe_standalone_eval.py"],
    deps = [
        ":lsm_linear_probe_standalone_trainer",
        ":lsm_supervised_utils",
        "//experimental/largesensormodels/scenic/models/lsm_vit_utils:model_utils",
        "//experimental/largesensormodels/scenic/utils:classification_utils",
        "//third_party/py/absl/logging",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_mae_reconstruction_eval",
    srcs = ["lsm_mae_reconstruction_eval.py"],
    deps = [
        ":lsm_mae_utils",
        "//experimental/largesensormodels/scenic/datasets:get_dataset",
        "//experimental/largesensormodels/scenic/trainers/masking:masker_config",
        "//pyglib:gfile",
        "//third_party/py/absl/flags",
        "//third_party/py/absl/logging",
        "//third_party/py/clu:periodic_actions",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_generative_task_standalone_eval",
    srcs = ["lsm_generative_task_standalone_eval.py"],
    deps = [
        ":lsm_mae_reconstruction_eval",
        ":lsm_mae_utils",
        "//third_party/py/absl/logging",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/train_lib:optax",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "linear_probe_utils",
    srcs = ["linear_probe_utils.py"],
    deps = [
        "//third_party/py/absl/logging",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/jax:optimizers",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/optax",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/model_lib/base_models:classification_model",
        "//third_party/py/scenic/model_lib/base_models:model_utils",
        "//third_party/py/scenic/train_lib:classification_trainer",
        "//third_party/py/scenic/train_lib:lr_schedules",
        "//third_party/py/scenic/train_lib:optimizers",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)

pytype_strict_library(
    name = "lsm_embedding_dump",
    srcs = ["lsm_embedding_dump.py"],
    deps = [
        ":lsm_mae_reconstruction_eval",
        ":lsm_mae_utils",
        "//pyglib:gfile",
        "//third_party/py/absl/logging",
        "//third_party/py/clu/metric_writers",
        "//third_party/py/flax:core",
        "//third_party/py/jax",
        "//third_party/py/ml_collections",
        "//third_party/py/numpy",
        "//third_party/py/scenic/dataset_lib:dataset_utils",
        "//third_party/py/scenic/google/xm:xm_utils",
        "//third_party/py/scenic/model_lib/base_models:base_model",
        "//third_party/py/scenic/model_lib/base_models:model_utils",
        "//third_party/py/scenic/train_lib:pretrain_utils",
        "//third_party/py/scenic/train_lib:train_utils",
    ],
)
